<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= story ? 'Editar' : 'Nova' %> Hist√≥ria</title>
  <link rel="stylesheet" href="/public/css/main.css">
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700;900&display=swap" rel="stylesheet">
</head>
<body class="admin-page">
  <div class="admin-container">
    <header class="admin-header">
      <h1>‚úçÔ∏è <%= story ? 'Editar' : 'Nova' %> Hist√≥ria</h1>
      <div class="admin-user">
        <a href="/admin" class="btn btn-small btn-secondary">‚Üê Voltar</a>
      </div>
    </header>

    <div class="admin-content">
      <form method="POST" action="/admin/story/save">
        <% if (story) { %>
          <input type="hidden" name="id" value="<%= story.id %>">
        <% } %>

        <div class="form-group">
          <label for="title">T√≠tulo da Hist√≥ria *</label>
          <input 
            type="text" 
            id="title" 
            name="title" 
            value="<%= story ? story.title : '' %>"
            placeholder="Ex: O Dilema Imposs√≠vel"
            required 
            autofocus>
        </div>

        <div class="form-group">
          <label for="description">Sinopse / Contexto</label>
          <textarea 
            id="description" 
            name="description" 
            rows="4"
            placeholder="Descreva o contexto da hist√≥ria baseada em acontecimentos reais..."
            ><%= story ? story.description : '' %></textarea>
        </div>

        <div class="form-group">
          <label for="genre">G√™nero / Tema</label>
          <select id="genre" name="genre">
            <option value="Drama Real" <%= story && story.genre === 'Drama Real' ? 'selected' : '' %>>
              Drama Real
            </option>
            <option value="Crime e Justi√ßa" <%= story && story.genre === 'Crime e Justi√ßa' ? 'selected' : '' %>>
              Crime e Justi√ßa
            </option>
            <option value="Suspense Psicol√≥gico" <%= story && story.genre === 'Suspense Psicol√≥gico' ? 'selected' : '' %>>
              Suspense Psicol√≥gico
            </option>
            <option value="Dilema Moral" <%= story && story.genre === 'Dilema Moral' ? 'selected' : '' %>>
              Dilema Moral
            </option>
            <option value="Conflito Familiar" <%= story && story.genre === 'Conflito Familiar' ? 'selected' : '' %>>
              Conflito Familiar
            </option>
            <option value="Decis√µes Profissionais" <%= story && story.genre === 'Decis√µes Profissionais' ? 'selected' : '' %>>
              Decis√µes Profissionais
            </option>
            <option value="Sobreviv√™ncia" <%= story && story.genre === 'Sobreviv√™ncia' ? 'selected' : '' %>>
              Sobreviv√™ncia
            </option>
            <option value="Mist√©rio Real" <%= story && story.genre === 'Mist√©rio Real' ? 'selected' : '' %>>
              Mist√©rio Real
            </option>
          </select>
        </div>

        <div class="form-group">
          <label for="cover_color">Cor do Card (Escolha tom s√≥brio)</label>
          <input 
            type="color" 
            id="cover_color" 
            name="cover_color" 
            value="<%= story ? story.cover_color : '#2d2d2d' %>">
        </div>

        <div class="form-group">
          <label for="status">Status</label>
          <select id="status" name="status">
            <option value="Em andamento" <%= story && story.status === 'Em andamento' ? 'selected' : '' %>>
              Em andamento
            </option>
            <option value="Completa" <%= story && story.status === 'Completa' ? 'selected' : '' %>>
              Completa
            </option>
            <option value="Em revis√£o" <%= story && story.status === 'Em revis√£o' ? 'selected' : '' %>>
              Em revis√£o
            </option>
          </select>
        </div>

        <div class="form-group">
          <button type="submit" class="btn btn-success btn-large">
            üíæ Salvar e Gerenciar Cap√≠tulos
          </button>
          <a href="/admin" class="btn btn-secondary btn-large">Cancelar</a>
        </div>
      </form>
    </div>
  </div>
</body>
</html>
